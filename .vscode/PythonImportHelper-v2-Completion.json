[
    {
        "label": "hashlib",
        "kind": 6,
        "isExtraImport": true,
        "importPath": "hashlib",
        "description": "hashlib",
        "detail": "hashlib",
        "documentation": {}
    },
    {
        "label": "json",
        "kind": 6,
        "isExtraImport": true,
        "importPath": "json",
        "description": "json",
        "detail": "json",
        "documentation": {}
    },
    {
        "label": "sys",
        "kind": 6,
        "isExtraImport": true,
        "importPath": "sys",
        "description": "sys",
        "detail": "sys",
        "documentation": {}
    },
    {
        "label": "datetime",
        "importPath": "datetime",
        "description": "datetime",
        "isExtraImport": true,
        "detail": "datetime",
        "documentation": {}
    },
    {
        "label": "urlopen",
        "importPath": "urllib.request",
        "description": "urllib.request",
        "isExtraImport": true,
        "detail": "urllib.request",
        "documentation": {}
    },
    {
        "label": "md5sum",
        "kind": 2,
        "importPath": "scripts.manifest",
        "description": "scripts.manifest",
        "peekOfCode": "def md5sum(filename):\n    with open(filename, 'rb') as f:\n        return hashlib.md5(f.read()).hexdigest()\ndef generate(filename, version):\n    return {\n        'checksum': md5sum(filename),\n        'changelog': 'Auto Released by Actions',\n        'targetAbi': '10.8.0.0',\n        'sourceUrl': 'https://github.com/metatube-community/jellyfin-plugin-metatube/releases/download/'\n                     f'v{version}/Jellyfin.MetaTube@v{version}.zip',",
        "detail": "scripts.manifest",
        "documentation": {}
    },
    {
        "label": "generate",
        "kind": 2,
        "importPath": "scripts.manifest",
        "description": "scripts.manifest",
        "peekOfCode": "def generate(filename, version):\n    return {\n        'checksum': md5sum(filename),\n        'changelog': 'Auto Released by Actions',\n        'targetAbi': '10.8.0.0',\n        'sourceUrl': 'https://github.com/metatube-community/jellyfin-plugin-metatube/releases/download/'\n                     f'v{version}/Jellyfin.MetaTube@v{version}.zip',\n        'timestamp': datetime.now().strftime('%Y-%m-%dT%H:%M:%SZ'),\n        'version': version\n    }",
        "detail": "scripts.manifest",
        "documentation": {}
    },
    {
        "label": "main",
        "kind": 2,
        "importPath": "scripts.manifest",
        "description": "scripts.manifest",
        "peekOfCode": "def main():\n    filename = sys.argv[1]\n    version = filename.split('@', maxsplit=1)[1] \\\n        .removeprefix('v') \\\n        .removesuffix('.zip')\n    with urlopen('https://raw.githubusercontent.com/metatube-community/jellyfin-plugin-metatube/dist/manifest.json') as f:\n        manifest = json.load(f)\n    manifest[0]['versions'].insert(0, generate(filename, version))\n    with open('manifest.json', 'w') as f:\n        json.dump(manifest, f, indent=2)",
        "detail": "scripts.manifest",
        "documentation": {}
    }
]